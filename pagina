import React from 'react'

export default function Home() {
  return (
    <main className="min-h-screen bg-white text-gray-900">
      <header className="p-4 shadow-md flex justify-between items-center">
        <h1 className="text-2xl font-bold">CRUMAFOOD</h1>
        <nav className="space-x-4">
          <a href="#catalogo">Cat√°logo</a>
          <a href="#como-funciona">C√≥mo funciona</a>
          <a href="#contacto">Contacto</a>
        </nav>
      </header>

      <section className="p-8 text-center bg-gray-100">
        <h2 className="text-3xl font-semibold mb-4">Teque√±os, empanadas y masas congeladas</h2>
        <p className="mb-6">Env√≠os a todo M√©xico desde Toluca ¬∑ Crudos y precocidos</p>
        <button className="px-6 py-3 bg-black text-white rounded-2xl">Hacer pedido</button>
      </section>

      <section id="catalogo" className="p-8">
        <h3 className="text-2xl font-bold mb-4">Categor√≠as</h3>
        <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
          <div className="p-4 border rounded-2xl">Teque√±os</div>
          <div className="p-4 border rounded-2xl">Empanadas</div>
          <div className="p-4 border rounded-2xl">Discos</div>
          <div className="p-4 border rounded-2xl">Masas</div>
        </div>
      </section>

      <footer className="p-6 bg-gray-900 text-white text-center">
        <p>CRUMAFOOD ¬∑ Negocio | Eventos sociales | Lunch</p>
      </footer>
    </main>
  )
}

// --- L√ìGICA DE PRECIOS AUTOM√ÅTICOS MENUD EO / MAYOREO ---
// Regla:
// 1 a 4 paquetes  -> precio_menudeo
// 5 o m√°s paquetes -> precio_mayoreo

// Ejemplo de estructura de producto
export const productExample = {
  id: 'teq-queso-8cm-25',
  nombre: 'Teque√±os de queso (8 cm) ‚Äì 25 pzs',
  categoria: 'Teque√±os Frescos',
  estado: 'crudo', // crudo | precocido
  presentacion: 'Paquete 25 pzs',
  precio_menudeo: 302,
  precio_mayoreo: 281,
}

// Funci√≥n para calcular precio unitario seg√∫n cantidad
export function getUnitPrice(quantity, product) {
  if (quantity >= 5) return product.precio_mayoreo
  return product.precio_menudeo
}

// Funci√≥n para calcular total del carrito
export function getItemTotal(quantity, product) {
  return getUnitPrice(quantity, product) * quantity
}


// ===============================
// CARRITO DE COMPRAS ‚Äì CRUMAFOOD
// ===============================

import { useState } from 'react'

export function useCart() {
  const [cart, setCart] = useState([])

  function addToCart(product, quantity = 1) {
    setCart(prev => {
      const existing = prev.find(item => item.id === product.id)
      if (existing) {
        return prev.map(item =>
          item.id === product.id
            ? { ...item, quantity: item.quantity + quantity }
            : item
        )
      }
      return [...prev, { ...product, quantity }]
    })
  }

  function removeFromCart(id) {
    setCart(prev => prev.filter(item => item.id !== id))
  }

  function updateQuantity(id, quantity) {
    setCart(prev =>
      prev.map(item =>
        item.id === id ? { ...item, quantity } : item
      )
    )
  }

  function getCartSubtotal() {
    return cart.reduce((total, item) => {
      const unitPrice = item.quantity >= 5 ? item.precio_mayoreo : item.precio_menudeo
      return total + unitPrice * item.quantity
    }, 0)
  }

  function isMayoreo() {
    return cart.some(item => item.quantity >= 5)
  }

  return {
    cart,
    addToCart,
    removeFromCart,
    updateQuantity,
    getCartSubtotal,
    isMayoreo,
  }
}

// MENSAJE FIJO DEL CARRITO
export const shippingNotice = "‚ùÑÔ∏è Todos nuestros productos se env√≠an congelados para conservar su calidad durante el env√≠o."


// ===============================
// ENV√çO AUTOM√ÅTICO ‚Äì CRUMAFOOD
// ===============================

// Zonas de env√≠o (ejemplo base)
export const shippingZones = {
  local: {
    label: 'Toluca y zona metropolitana',
    price: 120,
  },
  centro: {
    label: 'Centro del pa√≠s',
    price: 190,
  },
  nacional: {
    label: 'Resto de la Rep√∫blica Mexicana',
    price: 260,
  },
}

// Funci√≥n para calcular env√≠o seg√∫n zona
export function calculateShipping(zoneKey) {
  return shippingZones[zoneKey]?.price || 0
}

// Total final del pedido
export function getOrderTotal(subtotal, shipping) {
  return subtotal + shipping
}


// ===============================
// MENSAJE DE CONFIRMACI√ìN EN CHECKOUT
// ===============================

export const frozenDeliveryNotice = "‚ùÑÔ∏è Los productos se env√≠an congelados. Aseg√∫rate de que haya una persona disponible para recibirlos y conservarlos en congelaci√≥n al momento de la entrega."

// Este mensaje se muestra antes de confirmar el pago


// ===============================
// NOTIFICACI√ìN DE PEDIDOS POR WHATSAPP ‚Äì CRUMAFOOD
// ===============================

// Este mensaje se env√≠a autom√°ticamente al confirmar el pago
export function buildWhatsAppMessage(order) {
  return `üßæ NUEVO PEDIDO ‚Äì CRUMAFOOD

` +
    `Cliente: ${order.name}
` +
    `Tel√©fono: ${order.phone}

` +
    `Productos:
` +
    order.items.map(i => - ${i.quantity} x ${i.nombre}).join('
') +
    `

Subtotal: $${order.subtotal}` +
    `
Env√≠o: $${order.shipping}` +
    `
TOTAL: $${order.total}` +
    `

üìç Direcci√≥n:
${order.address}` +
    `

‚ùÑÔ∏è Entrega de productos congelados`;
}

// Opci√≥n simple (link WhatsApp Web)
export const WHATSAPP_ORDERS_PHONE = '5217225835173'

export function getWhatsAppLink(phone = WHATSAPP_ORDERS_PHONE, message) {
  return https://wa.me/${phone}?text=${encodeURIComponent(message)}
}



// ===============================
// CHECKOUT VISUAL ‚Äì CRUMAFOOD
// ===============================

import React from 'react'
import { shippingZones } from './shipping'
import { frozenDeliveryNotice } from './notices'

export function Checkout({ cartSubtotal, onPay }) {
  return (
    <section className="p-6 max-w-xl mx-auto">
      <h2 className="text-2xl font-bold mb-4">Finalizar pedido</h2>

      <form className="space-y-4">
        <input className="w-full p-3 border rounded-xl" placeholder="Nombre completo" />
        <input className="w-full p-3 border rounded-xl" placeholder="Tel√©fono" />
        <input className="w-full p-3 border rounded-xl" placeholder="Direcci√≥n completa" />
        <textarea className="w-full p-3 border rounded-xl" placeholder="Referencias de entrega" />

        <select className="w-full p-3 border rounded-xl">
          <option>Selecciona tu zona de env√≠o</option>
          {Object.entries(shippingZones).map(([key, zone]) => (
            <option key={key} value={key}>{zone.label} ‚Äì ${zone.price}</option>
          ))}
        </select>

        <div className="bg-gray-100 p-4 rounded-xl text-sm">
          {frozenDeliveryNotice}
        </div>

        <div className="flex justify-between font-semibold">
          <span>Total</span>
          <span>${cartSubtotal}</span>
        </div>

        <button type="button" onClick={onPay} className="w-full py-3 bg-black text-white rounded-2xl">
          Pagar con Mercado Pago
        </button>
      </form>
    </section>
  )
}  
